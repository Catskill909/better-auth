<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Better Auth</title>
    <link rel="stylesheet" href="/admin-styles.css">
    <script src="/modal-system.js"></script>
    <script src="/theme.js"></script>
    <script src="/better-auth-client.js"></script>
    <script src="/auth-client.js"></script>
</head>

<body>
    <div class="admin-container">
        <div class="admin-sidebar">
            <h2><i class="fas fa-shield-alt"></i>Admin Panel</h2>
            <nav>
                <a href="#" class="nav-item active" onclick="showSection('usersSection')">
                    <i class="fas fa-users"></i> Users
                </a>
                <a href="#" class="nav-item" onclick="showSection('sessionsSection')">
                    <i class="fas fa-clock"></i> Sessions
                </a>
                <a href="#" class="nav-item" onclick="showSection('mediaSection')">
                    <i class="fas fa-images"></i> Media Library
                </a>
                <a href="#" class="nav-item" onclick="showSection('settingsSection')">
                    <i class="fas fa-cog"></i> Settings
                </a>
                <a href="/dashboard.html" class="nav-item">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </a>
                <a href="#" class="nav-item" onclick="signOut()">
                    <i class="fas fa-sign-out-alt"></i> Sign Out
                </a>
            </nav>
            <div class="admin-info">
                <p><strong id="adminName">Loading...</strong></p>
                <p id="adminEmail"></p>
            </div>
        </div>

        <div class="admin-main">
            <!-- Users Section -->
            <div id="usersSection" class="section active">
                <div class="section-header">
                    <h1>User Management</h1>
                    <button onclick="showModal('createUserModal')" class="btn btn-primary"><i
                            class="fas fa-user-plus"></i>Create User</button>
                </div>

                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search users by email..."
                        onkeyup="if(event.key === 'Enter') searchUsers()">
                    <button onclick="searchUsers()" class="btn btn-secondary"><i
                            class="fas fa-search"></i>Search</button>
                    <button onclick="document.getElementById('searchInput').value=''; searchQuery=''; loadUsers();"
                        class="btn btn-outline"><i class="fas fa-times"></i>Clear</button>
                </div>

                <div class="stats-cards">
                    <div class="stat-card">
                        <h3 id="totalUsers">0</h3>
                        <p>Total Users</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="verifiedUsers">0</h3>
                        <p>Verified</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="bannedUsers">0</h3>
                        <p>Banned</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="adminUsers">0</h3>
                        <p>Admins</p>
                    </div>
                </div>

                <div class="table-container">
                    <table id="usersTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Verified</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr>
                                <td colspan="7" class="loading">Loading users...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="pagination">
                    <button id="prevPage" onclick="prevPage()" class="btn btn-outline">← Previous</button>
                    <span id="pageInfo">Page 1</span>
                    <button id="nextPage" onclick="nextPage()" class="btn btn-outline">Next →</button>
                </div>
            </div>

            <!-- Sessions Section -->
            <div id="sessionsSection" class="section">
                <div class="section-header">
                    <h1>Active Sessions</h1>
                    <button onclick="loadSessions()" class="btn btn-secondary"><i
                            class="fas fa-sync-alt"></i>Refresh</button>
                </div>
                <div id="sessionsContainer">
                    <p class="loading">Loading sessions...</p>
                </div>
            </div>

            <!-- Media Library Section -->
            <div id="mediaSection" class="section">
                <div class="section-header">
                    <h1>Media Library</h1>
                    <button onclick="document.getElementById('mediaUploadInput').click()" class="btn btn-primary">
                        <i class="fas fa-upload"></i> Upload Files
                    </button>
                </div>

                <input type="file" id="mediaUploadInput" multiple accept="image/*" style="display: none;"
                    onchange="uploadMediaFiles(this.files)">

                <div class="stats-cards">
                    <div class="stat-card">
                        <h3 id="totalMedia">0</h3>
                        <p>Total Files</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalAvatars">0</h3>
                        <p>Avatars</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalImages">0</h3>
                        <p>Media Images</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="storageUsed">0 MB</h3>
                        <p>Storage Used</p>
                    </div>
                </div>

                <div class="media-filters">
                    <select id="categoryFilter" onchange="filterMedia()">
                        <option value="">All Categories</option>
                        <option value="avatar">Avatars</option>
                        <option value="media">Media</option>
                    </select>
                    <button onclick="loadMedia()" class="btn btn-secondary"><i class="fas fa-sync-alt"></i>
                        Refresh</button>
                </div>

                <div id="mediaGrid" class="media-grid">
                    <p class="loading">Loading media files...</p>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settingsSection" class="section">
                <div class="section-header">
                    <h1>Settings</h1>
                </div>
                <div class="settings-content">
                    <h3>Admin Configuration</h3>
                    <p>Configure admin panel settings and preferences</p>
                    <div class="setting-item">
                        <label>Default User Role:</label>
                        <span>user</span>
                    </div>
                    <div class="setting-item">
                        <label>Admin Roles:</label>
                        <span>admin</span>
                    </div>
                    <div class="setting-item">
                        <label>Email Verification:</label>
                        <span>Enabled</span>
                    </div>
                    <div class="setting-item">
                        <label>Password Reset:</label>
                        <span>Enabled</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create User Modal -->
    <div id="createUserModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('createUserModal')">&times;</span>
            <h2>Create New User</h2>
            <form id="createUserForm" onsubmit="event.preventDefault(); createUser();">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="newUserName" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="newUserEmail" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <div class="password-wrapper">
                        <input type="password" id="newUserPassword" required minlength="8">
                        <button type="button" class="password-toggle" onclick="togglePassword('newUserPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="newUserRole">
                        <option value="user">User</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Create User</button>
                <button type="button" onclick="closeModal('createUserModal')" class="btn btn-secondary">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="editUserModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editUserModal')">&times;</span>
            <h2>Edit User</h2>
            <form id="editUserForm" onsubmit="event.preventDefault(); updateUser();">
                <input type="hidden" id="editUserId">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="editUserName" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="editUserEmail" required disabled>
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="editUserRole">
                        <option value="user">User</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="form-group checkbox-group">
                    <label class="checkbox-container">
                        <input type="checkbox" id="editUserVerified">
                        <span class="checkmark"></span>
                        <span class="checkbox-label">Email Verified</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">Update User</button>
                <button type="button" onclick="closeModal('editUserModal')" class="btn btn-secondary">Cancel</button>
            </form>
        </div>
    </div>

    <script src="/admin.js"></script>
</body>

</html>